<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Builder Journey</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Funnel+Sans:ital@0;1&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="journey"></div>
    
     <script>
        //settings
        let currentStep = 2;
        let totalSteps = 6;

        //creating journey html
        function renderJourney(currentStep,totalSteps) {
          let content = '<div class="journey__inner"><div class="blur"></div>';

          for (let i = 0; i < totalSteps; i++) {
            
            const stepComplete = (i < currentStep - 1);
            const stepCurrent = (i == currentStep - 1);
            const stepLast = (i == totalSteps - 1);

            let stepClasses = 'step';
            stepClasses += stepComplete ? ' complete' : '';
            stepClasses += stepCurrent ? ' current' : '';
            stepClasses += stepLast ? ' last' : '';

            content += '<div class="' + stepClasses + '">';

            if( i < totalSteps - 1) {
              content += '<div class="path"><svg width="100" height="10" viewBox="0 0 100 10" preserveAspectRatio="none" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="5" x2="100" y2="5" /></svg></div>';
            }

            if(stepCurrent && !stepLast) {
              content += '<div class="character__wrap"><div class="character">\
              <img src="./img/journey-character.svg"/>\
            </div>';
            }

            if(stepComplete) {
              
              content += '<div class="badge material-symbols-outlined">check</div><img src="./img/journey-stone-complete.svg" class="stone"/>';
          
            } else if (stepLast) {

              content += '<img src="./img/journey-destination.png" class="destination"/><img src="./img/journey-planet.svg" class="stone"/>';

            } else {

              content += '<div class="badge"></div><img src="./img/journey-stone.svg" class="stone"/>';
          
            }

            if(stepCurrent) {
              content += '</div>';
            }

            content += '</div>';

          }

          content += '</div>';

          document.querySelector('.journey').insertAdjacentHTML('beforeend',content);

          renderControls();
          scrollToCurrent();

        }

        //inserting controls html
        function renderControls() {

          const controls = '<div class="controls"><div class="controls__buttons"><button class="slide-left material-symbols-outlined">arrow_back</button><button class="slide-right material-symbols-outlined">arrow_forward</button></div><div class="controls__scrollbar"><div class="scrollbar__inner"></div></div>';

          document.querySelector('.journey').insertAdjacentHTML('afterend',controls);
        }

        //create scrollbar/click
        function triggerScroll(scrollLeft) {
          const container = document.querySelector('.journey');
          const buttonRight = document.querySelector('.slide-right');
          const buttonLeft = document.querySelector('.slide-left');

          const scrollOffset = scrollLeft / container.scrollWidth * 100;
          const scrollWidth = container.offsetWidth / container.scrollWidth;
          const scrollbar = document.querySelector('.scrollbar__inner');

          buttonRight.onclick = function () {
            const scrollLeft = container.scrollLeft += 500;
            triggerScroll(scrollLeft);
          };

          buttonLeft.onclick = function () {
            const scrollLeft = container.scrollLeft -= 500;
            triggerScroll(scrollLeft);
          };

          scrollbar.style.left = scrollOffset + '%';
          scrollbar.style.width = scrollWidth * 200 + 'px';

          if(container.scrollWidth > container.offsetWidth) {
              document.querySelector('.controls').style.display = 'block';
          }
        }
 
        //ensure current step starts in view
        function scrollToCurrent() {
          const container = document.querySelector('.journey');
          const currentPlacementX = document.querySelector('.current').getBoundingClientRect().left;

          if( currentPlacementX > container.offsetWidth) {
              container.scrollLeft = currentPlacementX;
              triggerScroll(currentPlacementX);
          } else {
            container.style.justifyContent = 'center';
            triggerScroll(0);
          }
        }

        //edit button controls
        function changeJourney() {
          currentStep = document.querySelector('input[name=currentStep]').value;
          totalSteps = document.querySelector('input[name=totalSteps]').value;

          //remove current
          document.querySelector('.journey').innerHTML = '';
          document.querySelector('.controls').remove();

          //recreate
          renderJourney(currentStep,totalSteps);
        }
        
        renderJourney(currentStep, totalSteps);

      </script>

      <div class="edits">
        <div>
          <label>Current Step</label>
          <input type="number" value="2" name="currentStep"/>
        </div>

        <div>
          <label>Total Steps</label>
          <input type="number" value="6" name="totalSteps"/>
        </div>
        <div>
          <button onclick="changeJourney()">Reset</button>
        </div>
      </div>
  </body>
</html>
